# SFC tests: Patch cases for compiler compatibility

mode = "sfc"

[[cases]]
name = "v-if with v-bind spread"
input = """
<script setup>
import MyButton from './MyButton.vue'
const isActive = true
const buttonProps = { type: 'primary' }
const handleClick = () => {}
</script>

<template>
  <MyButton v-if=\"isActive\" v-bind=\"buttonProps\" @click=\"handleClick\">Click</MyButton>
</template>
"""

[[cases]]
name = "v-model handler for ref"
input = """
<script setup>
import { ref } from 'vue'
const inputValue = ref('')
</script>

<template>
  <input v-model=\"inputValue\" />
</template>
"""

[[cases]]
name = "withDefaults type-based props runtime"
input = """
<script setup lang=\"ts\">
interface Props {
  size?: number
  color?: string
}

withDefaults(defineProps<Props>(), {
  size: 12,
  color: 'primary'
})
</script>

<template>
  <div>{{ size }} {{ color }}</div>
</template>
"""

[[cases]]
name = "duplicate imports should be filtered"
input = """
<script setup>
import { ref } from 'vue'
import { ref as ref2 } from 'vue'
const count = ref(0)
</script>

<template>
  <div>{{ count }}</div>
</template>
"""

[[cases]]
name = "top level await triggers async setup"
input = """
<script setup>
const value = await Promise.resolve(42)
</script>

<template>
  <div>{{ value }}</div>
</template>
"""

[[cases]]
name = "type comparison should not be stripped"
input = """
<script setup lang=\"ts\">
const props = defineProps<{ type: 'button' | 'submit' }>()
const isButton = props.type === 'button'
</script>

<template>
  <button :class=\"{ active: isButton }\">Click</button>
</template>
"""

[[cases]]
name = "static string with newline"
input = """
<template>
  <div>Line 1
Line 2</div>
</template>
"""

[[cases]]
name = "attribute with special characters"
input = """
<template>
  <div title='Line "quoted" & more'></div>
</template>
"""

[[cases]]
name = "multiline arrow function in handler"
input = """
<script setup>
import { ref } from 'vue'
const count = ref(0)
</script>

<template>
  <button @click=\"() => {\n  const next = count + 1;\n  console.log(next);\n  count = next;\n}\">Click</button>
</template>
"""

[[cases]]
name = "arrow function with ts annotation"
input = """
<script setup lang=\"ts\">
const items = [1, 2, 3]
</script>

<template>
  <div>{{ items.filter((x: number) => x > 1) }}</div>
</template>
"""

[[cases]]
name = "generic function call should be stripped"
input = """
<script setup lang=\"ts\">
const store = useStore<RootState>()
</script>

<template>
  <div>{{ store.state.count }}</div>
</template>
"""

[[cases]]
name = "ref with generic type should be stripped"
input = """
<script setup lang=\"ts\">
import { ref } from 'vue'
const count = ref<number>(0)
</script>

<template>
  <div>{{ count }}</div>
</template>
"""

[[cases]]
name = "v-slot with hyphenated name"
input = """
<script setup>
import MyList from './MyList.vue'
</script>

<template>
  <MyList>
    <template #item-header=\"{ item }\">
      <div>{{ item.title }}</div>
    </template>
  </MyList>
</template>
"""

[[cases]]
name = "v-for with custom directive"
input = """
<script setup>
const items = [1, 2, 3]
</script>

<template>
  <div v-for=\"item in items\" v-test=\"item\">{{ item }}</div>
</template>
"""
